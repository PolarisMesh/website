---
title: "健康检查"
linkTitle: "健康检查"
weight: 3
---

## 定义

健康检查提供了一种机制，使得控制面可以在一定时间段内，感知服务实例出现异常，从而将异常节点剔除，并通知给所有的消费者。健康检查有以下2种实现形式：

### 心跳上报

服务实例持续上报心跳给控制面，并与控制面约定TTL的时间段，控制面检查服务实例的心跳上报时间点，当发现当前时间相比实例最后一次上报时间已经超过```3*TTL```，就将实例标记为不健康，并通知给该服务的消费者。

![心跳上报](图片/健康检查/心跳上报.png)

### 主动探测

服务实例与控制面约定探测的方式（探测协议、接口、超时等）。控制面会定时探测服务实例的接口，当发现探测失败次数超过```n```，就将实例标记为不健康，并通知给该服务的消费者。

![主动探测](图片/健康检查/主动探测.png)